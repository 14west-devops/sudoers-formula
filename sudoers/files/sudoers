{% set sudoers = pillar.get('sudoers', {}) %}
{% set defaults = sudoers.get('defaults', []) %}
{% set aliases = sudoers.get('aliases', {}) %}
{% set host_aliases = aliases.get('hosts', []) %}
{% set user_aliases = aliases.get('users', []) %}
{% set cmnd_aliases = aliases.get('commands', []) %}
{% set runas_aliases = aliases.get('runas', []) %}
{% set users = sudoers.get('users', {}) %}
{% set groups = sudoers.get('groups', {}) %}
{% set includedir = sudoers.get('includedir', None) %}
#
# This file is managed by salt
#

{% for default in defaults -%}
Defaults {{ default }}
{% endfor %}

# Host alias specification
{% for name,hosts in host_aliases.items() %}
Host_Alias {{ name }} = {{ ",".join(hosts) }}
{% endfor %}

# User alias specification
{{ user_aliases }}

# Cmnd alias specification
{{ cmnd_aliases }}

# Runas alias specification
{{ runas_aliases }}

# User privilege specification
{{ users }}

# Group privilege specification
{{ groups }}

{% if includedir %}
includedir {{ includedir }}
{% else %}
#includedir /etc/sudoers.d
{% endif %}
